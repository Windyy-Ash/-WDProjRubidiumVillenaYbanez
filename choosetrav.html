<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>A Vast Journey Into the Wonders of Teyvat — Log in</title>
  <link rel="icon" type="image/x-icon" href="https://yoolk.ninja/wp-content/uploads/2021/08/Games-GenshinImpact-1024x1024.png" />
  <style>
    * { box-sizing: border-box; font-family: "Segoe UI", sans-serif; }

    body {
        margin: 0;
        height: 100vh;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        background: black;
    }

    .bg {
        position: fixed;
        inset: 0;
        background: url('https://media1.tenor.com/m/pKd1qbd4fAMAAAAd/genshin-impact-genshin.gif') center/cover no-repeat;
        filter: brightness(0.6) blur(5px);
        opacity: 0;
        transition: opacity 1s ease;
        z-index: -1;
    }

    .container {
        position: relative;
        z-index: 1;
        width: 360px;
        padding: 26px;
        border-radius: 18px;
        background: rgba(255,255,255,0.12);
        backdrop-filter: blur(16px);
        box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        color: #fff;
        animation: fadeIn 1.2s ease forwards;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    h2 {
        text-align: center;
        margin-bottom: 18px;
        font-family: 'Papyrus', fantasy;
        text-shadow: 0 0 8px #6dd5fa;
    }

    .switch {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-bottom: 18px;
    }

    .switch button {
        flex: 1;
        padding: 8px;
        border-radius: 10px;
        border: none;
        background: rgba(255,255,255,0.2);
        color: #fff;
        cursor: pointer;
        font-weight: bold;
        transition: 0.3s;
    }

    .switch button.active {
        background: linear-gradient(135deg, #6dd5fa, #2980b9);
        box-shadow: 0 0 8px #6dd5fa;
    }

    label { 
        font-size: 13px; 
        opacity: 0.9; 
    }
    .field { 
        position: relative; 
        margin-bottom: 10px;   
    }

    input {
        width: 100%;
        padding: 10px 36px 10px 12px;
        border-radius: 10px;
        border: none;
        outline: none;
        background: rgba(255,255,255,0.2);
        color: #fff;
    }

    input::placeholder { 
        color: #ddd; 
    }

    .check {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        color: #6dff9c;
        display: none;
    }

    .message { 
        font-size: 12px; 
        min-height: 16px; 
    }

    .strength {
        height: 6px;
        border-radius: 6px;
        background: rgba(255,255,255,0.2);
        overflow: hidden;
        margin-bottom: 10px;
    }

    .strength-bar {
        height: 100%;
        width: 0;
        transition: width 0.3s ease;
    }

    .submit {
        width: 100%;
        padding: 10px;
        border-radius: 12px;
        border: none;
        cursor: pointer;
        background: linear-gradient(135deg, #6dd5fa, #2980b9);
        color: white;
        margin-top: 10px;
        font-weight: bold;
        transition: 0.3s;
    }

    .submit:hover { 
        filter: brightness(1.2); 
    }

    .audio-toggle {
        position: absolute;
        top: 20px;
        right: 20px;
        padding: 8px 14px;
        border-radius: 999px;
        border: none;
        background: rgba(0,0,0,0.6);
        color: #fff;
        cursor: pointer;
        font-weight: bold;
        box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        transition: background 0.3s ease, transform 0.2s ease;
        z-index: 2;
    }

    .audio-toggle:hover {
        background: rgba(0,0,0,0.8);
        transform: translateY(-1px);
    }
  </style>
</head>

<body>

<audio id="bgm" loop preload="auto">
    <source src="audio/teyvat-theme.mp3" type="audio/mpeg">
    <source src="https://cdn.pixabay.com/download/audio/2022/10/18/audio_f3e45c8d54.mp3?filename=ethereal-vista-12499.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
</audio>

<button class="audio-toggle" id="audioToggle" type="button" aria-pressed="false">Play Music</button>

<div class="bg" id="bg"></div>

<div class="container">
  <h2 id="title">Sign Up</h2>

  <div class="switch">
    <button id="signupBtn" class="active" onclick="switchMode('signup')">Sign Up</button>
    <button id="loginBtn" onclick="switchMode('login')">Login</button>
  </div>

  <label>Username</label>
  <div class="field">
    <input id="username" type="text" placeholder="Enter username">
  </div>
  <div class="message" id="userMsg"></div>

  <label>Password</label>
  <div class="field">
    <input id="password" type="password" placeholder="Enter password">
    <span class="check" id="check">✔</span>
  </div>

  <div class="strength">
    <div class="strength-bar" id="strengthBar"></div>
  </div>
  <div class="message" id="passMsg"></div>

  <button class="submit" onclick="submitForm()">Continue</button>
</div>

<script>
    let mode = 'signup';
    const password = document.getElementById('password');
    const strengthBar = document.getElementById('strengthBar');
    const passMsg = document.getElementById('passMsg');
    const check = document.getElementById('check');
    const signupBtn = document.getElementById('signupBtn');
    const loginBtn = document.getElementById('loginBtn');
    const bgm = document.getElementById('bgm');
    const audioToggle = document.getElementById('audioToggle');
    let musicMuted = localStorage.getItem('musicMuted') === 'true';

    function persistMusicPreference(isMuted) {
        localStorage.setItem('musicMuted', isMuted ? 'true' : 'false');
    }

    function updateAudioToggleLabel() {
        const isPaused = bgm.paused;
        audioToggle.textContent = isPaused ? 'Play Music' : 'Mute Music';
        audioToggle.setAttribute('aria-pressed', isPaused ? 'false' : 'true');
    }

    function enableMusicOnce() {
        document.removeEventListener('click', enableMusicOnce);
        if (musicMuted) {
            updateAudioToggleLabel();
            return;
        }
        bgm.play().then(() => {
            musicMuted = false;
            persistMusicPreference(false);
            updateAudioToggleLabel();
        }).catch(() => {
            console.warn('Audio playback was prevented. Try clicking again.');
        });
    }

    document.addEventListener('click', enableMusicOnce, { once: true });

    audioToggle.addEventListener('click', () => {
        if (bgm.paused) {
            bgm.play().then(() => {
                musicMuted = false;
                persistMusicPreference(false);
                updateAudioToggleLabel();
            }).catch(() => {
                console.warn('Audio playback was prevented. Try clicking again.');
            });
        } else {
            bgm.pause();
            musicMuted = true;
            persistMusicPreference(true);
            updateAudioToggleLabel();
        }
    });

    if (musicMuted) {
        bgm.pause();
    }
    updateAudioToggleLabel();

    function switchMode(m) {
        mode = m;
        document.getElementById('title').textContent = m === 'signup' ? 'Sign Up' : 'Login';
        signupBtn.classList.toggle('active', m === 'signup');
        loginBtn.classList.toggle('active', m === 'login');
    }

    password.addEventListener('input', () => {
        const len = password.value.length;
        check.style.display = 'none';
        if (len === 0) {
            strengthBar.style.width = '0%';
            passMsg.textContent = '';
        } else if (len === 1) {
            strengthBar.style.width = '33%';
            strengthBar.style.background = '#ff6b6b';
            passMsg.textContent = 'Put 2 more characters';
        } else if (len === 2) {
            strengthBar.style.width = '66%';
            strengthBar.style.background = '#ffd56b';
            passMsg.textContent = 'Put 1 more character';
        } else {
            strengthBar.style.width = '100%';
            strengthBar.style.background = '#6dff9c';
            passMsg.textContent = '';
            check.style.display = 'inline';
        }
    });

    function submitForm() {
        const username = document.getElementById('username').value.trim();
        const pwd = password.value;
        const userMsg = document.getElementById('userMsg');
        userMsg.textContent = '';
        let users = JSON.parse(localStorage.getItem('users') || '[]');

    if (!username) { userMsg.textContent = 'Please enter a username.'; return; }

    if (mode === 'signup') {
        if (pwd.length < 3) { passMsg.textContent = 'Password too short.'; return; }
        if (users.includes(username)) { userMsg.textContent = 'Sorry, this username has been taken.'; return; }
        users.push(username);
        localStorage.setItem('users', JSON.stringify(users));
        alert('Account created! Welcome, ' + username);
    } else {
        if (!users.includes(username)) { userMsg.textContent = 'User not found.'; return; }
        alert('Welcome back, ' + username + '!');
    }

    const redirectLocal = 'travelers.html';
    const redirectOnline = 'https://windyy-ash.github.io/-WDProjRubidiumVillenaYbanez/travelers.html';

    fetch(redirectLocal)
        .then(res => {
        if (res.ok) {
            window.location.href = redirectLocal;
        } else {
            window.location.href = redirectOnline;
        }
        })
        .catch(() => {
        window.location.href = redirectOnline;
        });
        }

    const bg = document.getElementById('bg');
    let visible = false;
    setInterval(() => {
        visible = !visible;
        bg.style.opacity = visible ? '1' : '0';
    }, 5000);
</script>
</body>
</html>